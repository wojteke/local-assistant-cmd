2023-05-23 20:50:09.023665: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset json (/root/.cache/huggingface/datasets/json/default-977e0a308f638de0/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4)
100% 1/1 [00:00<00:00, 637.53it/s]
Loading cached split indices for dataset at /root/.cache/huggingface/datasets/json/default-977e0a308f638de0/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-bdb7cbbfbc43db48.arrow and /root/.cache/huggingface/datasets/json/default-977e0a308f638de0/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-803bf7240d09906b.arrow
100% 241/241 [01:12<00:00,  3.31it/s]
Raw model: eval_ppl=tensor(344.9181, device='cuda:0') eval_epoch_loss=tensor(5.8433, device='cuda:0')
100% 2167/2167 [31:27<00:00,  1.15it/s]
100% 241/241 [01:11<00:00,  3.39it/s]
Epoch: 0: train_ppl=tensor(2.1039, device='cuda:0') train_epoch_loss=tensor(0.7438, device='cuda:0') eval_ppl=tensor(1.8303, device='cuda:0') eval_epoch_loss=tensor(0.6045, device='cuda:0')
100% 2167/2167 [31:27<00:00,  1.15it/s]
100% 241/241 [01:10<00:00,  3.40it/s]
Epoch: 1: train_ppl=tensor(1.7714, device='cuda:0') train_epoch_loss=tensor(0.5718, device='cuda:0') eval_ppl=tensor(1.7782, device='cuda:0') eval_epoch_loss=tensor(0.5756, device='cuda:0')
100% 2167/2167 [31:26<00:00,  1.15it/s]
100% 241/241 [01:10<00:00,  3.40it/s]
Epoch: 2: train_ppl=tensor(1.5531, device='cuda:0') train_epoch_loss=tensor(0.4403, device='cuda:0') eval_ppl=tensor(1.8118, device='cuda:0') eval_epoch_loss=tensor(0.5943, device='cuda:0')
trainable params: 1474560 || all params: 775504640 || trainable%: 0.19014199579772986
Found cached dataset json (/root/.cache/huggingface/datasets/json/default-977e0a308f638de0/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4)
100% 1/1 [00:00<00:00, 807.06it/s]
Loading cached split indices for dataset at /root/.cache/huggingface/datasets/json/default-977e0a308f638de0/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-bdb7cbbfbc43db48.arrow and /root/.cache/huggingface/datasets/json/default-977e0a308f638de0/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-803bf7240d09906b.arrow
100% 241/241 [01:13<00:00,  3.29it/s]
Raw model: eval_ppl=tensor(344.9181, device='cuda:0') eval_epoch_loss=tensor(5.8433, device='cuda:0')
 96% 2085/2167 [22:44<00:53,  1.53it/s]

 trainable params: 1,474,560 || all params: 775,504,640 || trainable%: 0.19014199579772986
Downloading and preparing dataset json/default to /root/.cache/huggingface/datasets/json/default-420b36b2666441a4/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4...
Downloading data files: 100% 1/1 [00:00<00:00, 7025.63it/s]
Extracting data files: 100% 1/1 [00:00<00:00, 1429.06it/s]
Dataset json downloaded and prepared to /root/.cache/huggingface/datasets/json/default-420b36b2666441a4/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4. Subsequent calls will reuse this data.
100% 1/1 [00:00<00:00, 210.48it/s]
100% 241/241 [01:16<00:00,  3.17it/s]
Raw model: eval_ppl=tensor(344.9181, device='cuda:0') eval_epoch_loss=tensor(5.8433, device='cuda:0')
100% 2167/2167 [23:35<00:00,  1.53it/s]
100% 241/241 [01:12<00:00,  3.34it/s]
Epoch: 0: train_ppl=tensor(2.0355, device='cuda:0') train_epoch_loss=tensor(0.7107, device='cuda:0') eval_ppl=tensor(1.7380, device='cuda:0') eval_epoch_loss=tensor(0.5527, device='cuda:0')
100% 2167/2167 [23:35<00:00,  1.53it/s]
100% 241/241 [01:12<00:00,  3.34it/s]
Epoch: 1: train_ppl=tensor(1.8016, device='cuda:0') train_epoch_loss=tensor(0.5887, device='cuda:0') eval_ppl=tensor(1.7162, device='cuda:0') eval_epoch_loss=tensor(0.5401, device='cuda:0')
100% 2167/2167 [23:35<00:00,  1.53it/s]
100% 241/241 [01:12<00:00,  3.34it/s]
Epoch: 2: train_ppl=tensor(1.7752, device='cuda:0') train_epoch_loss=tensor(0.5739, device='cuda:0') eval_ppl=tensor(1.7070, device='cuda:0') eval_epoch_loss=tensor(0.5347, device='cuda:0')